template_id: dg.screening.pep_sanctions
template_version: "2026.02.01"
domain: banking_aml
reg_pack_id: "CA-SANCTIONS-SCREEN"
reg_pack_version: "2025.1"

ui:
  title: "PEP / Sanctions Screening"
  summary_tokens:
    - { field: screen.sanctions_match }
    - { field: screen.pep_match }
    - { field: screen.adverse_media }
    - { field: edd.completed }

fields:
  screen.sanctions_match:
    label: "Sanctions Match"
    control_type: toggle
    default: false

  screen.pep_match:
    label: "PEP Match"
    control_type: toggle
    default: false

  screen.adverse_media:
    label: "Adverse Media"
    control_type: toggle
    default: false

  screen.previous_account_closures:
    label: "Previous Account Closures"
    control_type: toggle
    default: false

  screen.prior_sars_filed:
    label: "Prior SARs Filed"
    control_type: select
    options:
      - { value: "0", label: "0" }
      - { value: "1", label: "1" }
      - { value: "2", label: "2" }
      - { value: "3_plus", label: "3+" }
    default: "0"
    help_text: "Prior SAR history indicates elevated risk"

  match.type:
    label: "Match Type"
    control_type: select
    options:
      - { value: exact, label: "Exact Match" }
      - { value: fuzzy_high, label: "Fuzzy (High Confidence)" }
      - { value: fuzzy_medium, label: "Fuzzy (Medium Confidence)" }
      - { value: false_positive, label: "False Positive" }
    default: fuzzy_medium

  match.list_source:
    label: "List Source"
    control_type: select
    options:
      - { value: ofac_sdn, label: "OFAC SDN" }
      - { value: un_sanctions, label: "UN Sanctions" }
      - { value: eu_sanctions, label: "EU Sanctions" }
      - { value: ca_sema, label: "Canadian SEMA" }
      - { value: pep_database, label: "PEP Database" }
      - { value: adverse_media, label: "Adverse Media" }
    default: pep_database

  edd.required:
    label: "EDD Required"
    control_type: toggle
    default: false

  edd.completed:
    label: "EDD Completed"
    control_type: select
    options:
      - { value: "yes", label: "Yes" }
      - { value: "no", label: "No" }
      - { value: "na", label: "N/A" }
    default: "na"

  edd.senior_management_approval:
    label: "Senior Management Approval"
    control_type: select
    options:
      - { value: "yes", label: "Yes" }
      - { value: "no", label: "No" }
      - { value: "na", label: "N/A" }
    default: "na"

field_groups:
  - name: "Screening Results"
    fields: [screen.sanctions_match, screen.pep_match, screen.adverse_media, screen.previous_account_closures, screen.prior_sars_filed]
  - name: "Match Details"
    fields: [match.type, match.list_source]
  - name: "Enhanced Due Diligence"
    fields: [edd.required, edd.completed, edd.senior_management_approval]

evidence:
  - { id: gov_photo_id, label: "Government Photo ID", default: true }
  - { id: proof_of_address_lt_3mo, label: "Proof of Address (< 3mo)", default: false }
  - { id: source_of_wealth_documented, label: "Source of Wealth Documentation", default: false }
  - { id: beneficial_ownership_declaration, label: "Beneficial Ownership Declaration", default: false }

visibility_rules:
  - when: { or: [{ true: [screen.pep_match] }, { true: [screen.sanctions_match] }] }
    show_fields: [edd.required, edd.completed, edd.senior_management_approval]
  - when: { and: [{ false: [screen.pep_match] }, { false: [screen.sanctions_match] }] }
    hide_fields: [edd.required, edd.completed, edd.senior_management_approval]

decision_rules:
  # BLOCK rules (highest severity)
  - when: { true: [screen.sanctions_match] }
    outcome:
      decision: block
      code: SCR_BLOCK_SANCTIONS
      label: "BLOCK + Report"
      severity: critical
      citations: ["Sanctions:Block", "SEMA", "OFAC"]

  # Exact match on high-risk list
  - when: { and: [{ eq: [match.type, exact] }, { in: [match.list_source, [ofac_sdn, un_sanctions, ca_sema]] }] }
    outcome:
      decision: block
      code: SCR_BLOCK_EXACT_MATCH
      label: "BLOCK (Exact Match)"
      severity: critical
      citations: ["Sanctions:ExactMatch"]

  # Cumulative SAR rule - 3+ SARs = decline
  - when: { eq: [screen.prior_sars_filed, "3_plus"] }
    outcome:
      decision: decline
      code: SCR_DECLINE_SAR_HISTORY
      label: "DECLINE (SAR Pattern)"
      severity: critical
      citations: ["Policy:RiskAppetite", "FINTRAC:PatternOfSuspicion"]

  # Previous closures + adverse media = decline
  - when: { and: [{ true: [screen.adverse_media] }, { true: [screen.previous_account_closures] }] }
    outcome:
      decision: decline
      code: SCR_DECLINE_ADVERSE_CLOSURE
      label: "DECLINE (Adverse + Closure)"
      severity: critical
      citations: ["Policy:AdverseMedia", "Policy:RiskAppetite"]

  # Previous account closures - escalate
  - when: { true: [screen.previous_account_closures] }
    outcome:
      decision: escalate
      code: SCR_ESC_PRIOR_CLOSURE
      label: "ESCALATE (Prior Closure)"
      severity: warning
      citations: ["FINTRAC:ExitedCustomer"]

  # Adverse media alone - escalate for review
  - when: { true: [screen.adverse_media] }
    outcome:
      decision: escalate
      code: SCR_ESC_ADVERSE_MEDIA
      label: "ESCALATE (Adverse Media)"
      severity: warning
      citations: ["FINTRAC:AdverseMedia"]

  # 2 prior SARs - enhanced monitoring
  - when: { eq: [screen.prior_sars_filed, "2"] }
    outcome:
      decision: escalate
      code: SCR_ESC_SAR_HISTORY
      label: "ESCALATE (SAR History)"
      severity: warning
      citations: ["FINTRAC:EnhancedMonitoring"]

  # PEP with complete EDD and senior approval
  - when: { and: [{ true: [screen.pep_match] }, { eq: [edd.completed, "yes"] }, { eq: [edd.senior_management_approval, "yes"] }] }
    outcome:
      decision: approve
      code: SCR_APPROVE_PEP_EDD
      label: "APPROVE (EDD Complete)"
      severity: warning
      citations: ["FINTRAC:PEPEDD"]

  # PEP without EDD
  - when: { and: [{ true: [screen.pep_match] }, { or: [{ eq: [edd.completed, "no"] }, { eq: [edd.completed, "na"] }] }] }
    outcome:
      decision: hold
      code: SCR_HOLD_PEP
      label: "HOLD (Pending EDD)"
      severity: warning
      citations: ["FINTRAC:PEPEDD"]

  # False positive - clear
  - when: { eq: [match.type, false_positive] }
    outcome:
      decision: approve
      code: SCR_APPROVE_FP
      label: "APPROVE (False Positive)"
      severity: normal
      citations: ["Policy:FalsePositiveResolution"]

  # Default approve
  - when: { default: true }
    outcome:
      decision: approve
      code: SCR_APPROVE_CLEAR
      label: "APPROVE"
      severity: normal
      citations: ["Policy:ScreeningClear"]

expected_outcomes:
  - { scenario: "No matches, clear screening", outcome: "APPROVE" }
  - { scenario: "False positive resolved", outcome: "APPROVE (False Positive)" }
  - { scenario: "PEP match, EDD complete, approved", outcome: "APPROVE (EDD Complete)" }
  - { scenario: "PEP match, EDD pending", outcome: "HOLD (Pending EDD)" }
  - { scenario: "Adverse media alone", outcome: "ESCALATE (Adverse Media)" }
  - { scenario: "Previous account closure", outcome: "ESCALATE (Prior Closure)" }
  - { scenario: "2 prior SARs", outcome: "ESCALATE (SAR History)" }
  - { scenario: "Adverse media + previous closures", outcome: "DECLINE (Adverse + Closure)" }
  - { scenario: "3+ prior SARs", outcome: "DECLINE (SAR Pattern)" }
  - { scenario: "Sanctions match", outcome: "BLOCK + Report" }
  - { scenario: "Exact match on OFAC/UN/SEMA", outcome: "BLOCK (Exact Match)" }
