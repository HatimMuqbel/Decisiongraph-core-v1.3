# DecisionGraph API - Railway Deployment
providers = ["python"]

[phases.setup]
nixPkgs = ["python312", "python312Packages.pip"]

[phases.install]
cmds = [
  "echo '=== Python version ===' && python3 --version && which python3",
  "pip install --no-cache-dir --break-system-packages -r requirements.txt",
  "python3 -c \"import ast; ast.parse(open('service/routers/report.py').read()); print('report.py syntax OK')\""
]

[start]
cmd = "python3 -m uvicorn service.main:app --host 0.0.0.0 --port ${PORT:-8000}"

[variables]
PYTHONUNBUFFERED = "1"
PYTHONPATH = "/app:/app/src"
